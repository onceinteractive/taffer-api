<div id="l-message-recipients" class="m-blade">
  <blade-header blade-title="{{conversationTitle}}" back="back()"></blade-header>

    <div id="l-conversation-container">
      <div class="l-conversation-message" ng-repeat="message in messageThread.messages track by message._id" on-last-element>

        <div class="l-conversation-time">
          <div><relative-time datetime="{{message.sentOn}}"></relative-time></div>
        </div>

        <div class="l-conversation-message-container">
          <div class="l-their-avatar">
            <user-avatar avatar-source="{{message.from.pictureURI}}"
              avatar-role="{{message.from.role}}"
              ng-hide="message.from.mine"></user-avatar>
          </div>
          <div class="l-conversation-text-container">
            <div class="l-conversation-their-name" ng-hide="message.from.mine">{{message.from.firstName}} {{message.from.lastName}}</div>
            <div class="l-conversation-text" ng-class="{myMessage: message.from.mine}">
              <div ng-bind-html="formatMessage(message.message)"></div>
              <br ng-if="message.imageKey && message.message"/>
              <img ng-if="message.imageKey"
                ng-src="{{getImageURL(message.imageKey)}}"
                ng-click="viewImage(message.imageKey)"
                image-load-dispatcher/>
            </div>
          </div>
          <div class="l-my-avatar">
            <user-avatar avatar-source="{{message.from.pictureURI}}"
              avatar-role="{{message.from.role}}"
              ng-show="message.from.mine"></user-avatar>
          </div>
        </div>

      </div>
    </div>

    <div id="l-messages-bottom"></div>

    <message-input
      message-model="newMessage"
      send-message="sendMessage()"
      file="file">
    </message-input>

</div>
